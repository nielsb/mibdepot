#!/bin/sh

TMP=tmp/ieee
DIR=$PWD/new/ieee

rm -fr $TMP
mkdir -p $TMP
( cd $TMP
  wget -r -A .mib -np -nd -nv http://www.ieee802.org/1/files/public/MIBs/
  rm -f 802*
)

rm -fr $DIR
mkdir -p $DIR
for f in $TMP/*
do
    g=$(echo $f | sed -e 's/-[0-9Z]*.mib/.txt/' -e s%$TMP/%%)
    sed -e 's/\r//' $f | awk '{if(NR==1)sub(/^[\xef\xbb\xbf]*/,"");print}' >$DIR/$g
done

for f in $DIR/*.txt
do
    g=$(echo $f | sed s/.txt/.mib/)
    if [ -r $g ]; then
	rm $g
    fi
done
rm -f $DIR/lldp.mib $DIR/lldp_dot1.mib $DIR/lldp_dot3.mib

# patch -d $DIR <ieee.diff
